<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    @media print {
      .no-print { display: none; }
      body { font-size: 10px; }
    }
    table { font-size: 11px; }
    th, td { padding: 3px !important; white-space: nowrap; }
    .weekend { background-color: #ffe6e6 !important; }
  </style>
</head>

<body class="container-fluid mt-3">
  <div class="no-print mb-3">
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">‚¨ÖÔ∏è Back</a>
    <button onclick="window.print()" class="btn btn-primary">üñ®Ô∏è Print</button>
    
    <form method="get" class="d-inline-block ms-3">
      <label class="me-2">‡¶Æ‡¶æ‡¶∏ ‡¶ì ‡¶¨‡¶õ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®:</label>
      <select name="month" class="form-select d-inline-block" style="width: auto;">
        <option value="1" {% if month == 1 %}selected{% endif %}>‡¶ú‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶∞‡¶ø</option>
        <option value="2" {% if month == 2 %}selected{% endif %}>‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡ßü‡¶æ‡¶∞‡¶ø</option>
        <option value="3" {% if month == 3 %}selected{% endif %}>‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö</option>
        <option value="4" {% if month == 4 %}selected{% endif %}>‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤</option>
        <option value="5" {% if month == 5 %}selected{% endif %}>‡¶Æ‡ßá</option>
        <option value="6" {% if month == 6 %}selected{% endif %}>‡¶ú‡ßÅ‡¶®</option>
        <option value="7" {% if month == 7 %}selected{% endif %}>‡¶ú‡ßÅ‡¶≤‡¶æ‡¶á</option>
        <option value="8" {% if month == 8 %}selected{% endif %}>‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü</option>
        <option value="9" {% if month == 9 %}selected{% endif %}>‡¶∏‡ßá‡¶™‡ßç‡¶ü‡ßá‡¶Æ‡ßç‡¶¨‡¶∞</option>
        <option value="10" {% if month == 10 %}selected{% endif %}>‡¶Ö‡¶ï‡ßç‡¶ü‡ßã‡¶¨‡¶∞</option>
        <option value="11" {% if month == 11 %}selected{% endif %}>‡¶®‡¶≠‡ßá‡¶Æ‡ßç‡¶¨‡¶∞</option>
        <option value="12" {% if month == 12 %}selected{% endif %}>‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞</option>
      </select>
      <select name="year" class="form-select d-inline-block ms-2" style="width: auto;">
        {% for y in available_years %}
        <option value="{{ y }}" {% if year == y %}selected{% endif %}>{{ y }}</option>
        {% endfor %}
      </select>
      <button type="submit" class="btn btn-success ms-2">‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
    </form>
  </div>

  <div class="text-center mb-4">
    <h4 class="text-primary">‡¶Ü‡¶≤-‡¶á‡¶®‡¶∏‡¶æ‡¶´ ‡¶ï‡ßç‡¶∑‡ßÅ‡¶¶‡ßç‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶∏‡¶Æ‡¶¨‡¶æ‡¶Ø‡¶º ‡¶∏‡¶Æ‡¶ø‡¶§‡¶ø ‡¶≤‡¶ø:</h4>
    <h5>‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶Ü‡¶∞‡ßç‡¶•‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</h5>
    <p>‡¶Æ‡¶æ‡¶∏: {{ month_name|default('') }} {{ year|default('') }}</p>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-sm">
      <thead class="table-dark">
        <tr>
          <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
          <th>‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º</th>
          <th>‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø</th>
          <th>‡¶ï‡¶≤‡ßç‡¶Ø‡¶æ‡¶£ ‡¶´‡¶ø</th>
          <th>‡¶≠‡¶∞‡ßç‡¶§‡¶ø ‡¶´‡¶ø</th>
          <th>‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶´‡¶ø</th>
          <th>‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶® ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º</th>
          <th>‡¶Æ‡ßã‡¶ü ‡¶Ü‡¶Ø‡¶º</th>
          <th>‡¶≤‡ßã‡¶® ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®</th>
          <th>‡¶≤‡¶æ‡¶≠</th>
          <th>‡¶≤‡¶æ‡¶≠‡ßç‡¶Ø‡¶æ‡¶Ç‡¶∂ ‡¶∏‡¶π ‡¶≤‡ßã‡¶®</th>
          <th>‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º ‡¶´‡ßá‡¶∞‡¶§</th>
          <th>‡¶ñ‡¶∞‡¶ö</th>
          <th>‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º</th>
          <th>‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</th>
        </tr>
      </thead>
      <tbody>
        {% if daily_data %}
        {% for day in range(1, (last_day|default(31)) + 1) %}
        {% set day_data = daily_data.get(day, {}) %}
        <tr {% if day_data.get('is_weekend', False) %}class="weekend"{% endif %}>
          <td>{{ day }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('savings', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('installments', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('welfare_fee', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('admission_fee', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('service_charge', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('capital_savings', 0)) }}</td>
          <td class="text-end"><strong>{{ "{:,.0f}".format(day_data.get('total_income', 0)) }}</strong></td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('loan_given', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('interest', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('loan_with_interest', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('savings_return', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('expenses', 0)) }}</td>
          <td class="text-end">{{ "{:,.0f}".format(day_data.get('total_expense', 0)) }}</td>
          <td class="text-end"><strong>{{ "{:,.0f}".format(day_data.get('balance', 0)) }}</strong></td>
        </tr>
        {% endfor %}
        {% else %}
        <tr>
          <td colspan="15" class="text-center">‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>

  <!-- Summary Section -->
  <div class="mt-4">
    <h5 class="text-center">‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ / Monthly Summary</h5>
    <table class="table table-bordered table-sm mt-3">
      <tbody>
        <tr class="table-secondary">
          <td><strong>‡¶Æ‡¶æ‡¶∏ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ / Opening Balance:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(opening_balance|default(0)) }}</strong></td>
        </tr>
        <tr class="table-info">
          <td><strong>‡¶Æ‡ßã‡¶ü ‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶® ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º / Total Capital Savings:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(total_capital_savings|default(0)) }}</strong></td>
        </tr>
        <tr class="table-warning">
          <td><strong>‡¶Æ‡ßã‡¶ü ‡¶≤‡ßã‡¶® ‡¶¨‡¶ø‡¶§‡¶∞‡¶£ / Total Loan Distributed:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(total_loan_distributed|default(0)) }}</strong></td>
        </tr>
        <tr>
          <td>‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶® ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º / Capital Savings:</td>
          <td class="text-end">‡ß≥{{ "{:,.0f}".format(total_capital_savings|default(0)) }}</td>
        </tr>
        <tr class="table-success">
          <td><strong>‡¶≤‡¶æ‡¶≠‡ßç‡¶Ø‡¶æ‡¶Ç‡¶∂ / Interest:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(total_interest|default(0)) }}</strong></td>
        </tr>
        <tr class="table-light">
          <td>‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶¨‡¶ï‡ßá‡¶Ø‡¶º‡¶æ / Previous Outstanding:</td>
          <td class="text-end">‡ß≥{{ "{:,.0f}".format(prev_remaining|default(0)) }}</td>
        </tr>
        <tr class="table-warning">
          <td><strong>‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ï‡ßá‡¶Ø‡¶º‡¶æ / Total Outstanding:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(current_remaining|default(0)) }}</strong></td>
        </tr>
        <tr>
          <td>‡¶ñ‡¶∞‡¶ö / Expenses:</td>
          <td class="text-end">‡ß≥{{ "{:,.0f}".format(total_monthly_expenses|default(0)) }}</td>
        </tr>
        <tr class="table-danger">
          <td><strong>‡¶Æ‡ßã‡¶ü ‡¶ñ‡¶∞‡¶ö / Total Expenses:</strong></td>
          <td class="text-end"><strong>‡ß≥{{ "{:,.0f}".format(total_monthly_expenses|default(0)) }}</strong></td>
        </tr>
      </tbody>
    </table>
  </div>
</body>
</html>
