<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Customer Details</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="container mt-5">
  <h2 class="mb-4">ğŸ‘¤ Customer Details</h2>

  <div class="card shadow mb-4">
    <div class="card-body">
      <h4>ğŸ‘¤ {{ customer.name }}</h4>
      <div class="row">
        <div class="col-md-6">
          <p><strong>à¦¸à¦¦à¦¸à§à¦¯à¦¾ à¦¨à¦‚:</strong> {{ customer.member_no or 'N/A' }}</p>
          <p><strong>ğŸ“ à¦®à§‹à¦¬à¦¾à¦‡à¦²:</strong> {{ customer.phone }}</p>
          <p><strong>ğŸ‘¨ à¦ªà¦¿à¦¤à¦¾/à¦¸à§à¦¬à¦¾à¦®à§€:</strong> {{ customer.father_husband or 'N/A' }}</p>
          <p><strong>ğŸ˜ï¸ à¦—à§à¦°à¦¾à¦®:</strong> {{ customer.village or 'N/A' }}</p>
          <p><strong>ğŸ¤ à¦ªà§‹à¦¸à§à¦Ÿ:</strong> {{ customer.post or 'N/A' }}</p>
          <p><strong>ğŸ›ï¸ à¦¥à¦¾à¦¨à¦¾:</strong> {{ customer.thana or 'N/A' }}</p>
        </div>
        <div class="col-md-6">
          <p><strong>ğŸ›ï¸ à¦œà§‡à¦²à¦¾:</strong> {{ customer.district or 'N/A' }}</p>
          <p><strong>ğŸ¤ à¦œà¦¾à¦®à¦¿à¦¨à¦¦à¦¾à¦°:</strong> {{ customer.granter or 'N/A' }}</p>
          <p><strong>ğŸ’¼ à¦ªà§‡à¦¶à¦¾:</strong> {{ customer.profession or 'N/A' }}</p>
          <p><strong>ğŸ« NID:</strong> {{ customer.nid_no or 'N/A' }}</p>
          <p><strong>ğŸ’µ à¦­à¦°à§à¦¤à¦¿ à¦«à¦¿:</strong> à§³{{ "{:,.2f}".format(customer.admission_fee or 0) }}</p>
          <p><strong>ğŸ‘¨â€ğŸ’¼ Staff:</strong> {{ customer.staff.name if customer.staff else 'N/A' }}</p>
          <p><strong>ğŸ“… à¦¯à§‹à¦— à¦¤à¦¾à¦°à¦¿à¦–:</strong> {{ customer.created_date.strftime('%Y-%m-%d') }}</p>
        </div>
      </div>
      {% if customer.address %}
      <p class="mt-2"><strong>ğŸ“ à¦ à¦¿à¦•à¦¾à¦¨à¦¾:</strong> {{ customer.address }}</p>
      {% endif %}
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card shadow p-3 bg-primary text-white">
        <h5>Total Loan</h5>
        <h3>à§³{{ "{:,.2f}".format(customer.total_loan or 0) }}</h3>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow p-3 bg-danger text-white">
        <h5>Remaining Loan</h5>
        <h3>à§³{{ "{:,.2f}".format(customer.remaining_loan or 0) }}</h3>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow p-3 bg-success text-white">
        <h5>Total Collected</h5>
        <h3>à§³{{ "{:,.2f}".format(total_collected or 0) }}</h3>
      </div>
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-md-12">
      <div class="card shadow p-3">
        <h5>Savings Balance</h5>
        <h3 class="text-success">à§³{{ "{:,.2f}".format(customer.savings_balance or 0) }}</h3>
      </div>
    </div>
  </div>

  <h4 class="mt-4">ğŸ’° Loan Collection History</h4>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Amount</th>
        <th>Date</th>
        <th>Collected By</th>
      </tr>
    </thead>
    <tbody>
      {% for lc in loan_collections %}
      <tr>
        <td>à§³{{ "{:,.2f}".format(lc.amount or 0) }}</td>
        <td>{{ lc.collection_date.strftime('%Y-%m-%d %H:%M') }}</td>
        <td>{{ lc.staff.name if lc.staff else 'N/A' }}</td>
      </tr>
      {% endfor %}
      {% if not loan_collections %}
      <tr>
        <td colspan="3" class="text-center">No loan collections yet</td>
      </tr>
      {% endif %}
    </tbody>
  </table>

  <h4 class="mt-4">ğŸ¦ Savings Collection History</h4>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Amount</th>
        <th>Date</th>
        <th>Collected By</th>
      </tr>
    </thead>
    <tbody>
      {% for sc in saving_collections %}
      <tr>
        <td>à§³{{ "{:,.2f}".format(sc.amount or 0) }}</td>
        <td>{{ sc.collection_date.strftime('%Y-%m-%d %H:%M') }}</td>
        <td>{{ sc.staff.name if sc.staff else 'N/A' }}</td>
      </tr>
      {% endfor %}
      {% if not saving_collections %}
      <tr>
        <td colspan="3" class="text-center">No savings collections yet</td>
      </tr>
      {% endif %}
    </tbody>
  </table>

  <h4 class="mt-4">ğŸ’µ Savings Withdrawal History</h4>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Amount</th>
        <th>Date</th>
        <th>Note</th>
      </tr>
    </thead>
    <tbody>
      {% for w in withdrawals %}
      <tr class="table-danger">
        <td>à§³{{ "{:,.2f}".format(w.amount or 0) }}</td>
        <td>{{ w.date.strftime('%Y-%m-%d %H:%M') }}</td>
        <td>{{ w.note or '-' }}</td>
      </tr>
      {% endfor %}
      {% if not withdrawals %}
      <tr>
        <td colspan="3" class="text-center">No withdrawals yet</td>
      </tr>
      {% endif %}
    </tbody>
  </table>

  <div class="alert alert-info mt-3">
    <strong>à¦®à§‹à¦Ÿ à¦‰à¦¤à§à¦¤à§‹à¦²à¦¨:</strong> à§³{{ "{:,.2f}".format(total_withdrawn or 0) }}
  </div>

  <a href="{{ url_for('customer_details_print', id=customer.id) }}" class="btn btn-primary mt-3" target="_blank">ğŸ–¨ï¸ Print Details</a>
  <a href="{{ url_for('loan_customers') }}" class="btn btn-secondary mt-3">â¬…ï¸ Back to Loan Customers</a>
</body>
</html>
