<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    @media print {
      .no-print { display: none; }
      body { font-size: 11px; }
    }
    table { font-size: 13px; }
    th, td { padding: 4px !important; }
  </style>
</head>

<body class="container-fluid mt-3">
  <div class="no-print mb-3">
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">‚¨ÖÔ∏è Back</a>
    <button onclick="window.print()" class="btn btn-primary">üñ®Ô∏è Print</button>
    
    <form method="get" class="d-inline-block ms-3">
      <label class="me-2">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®:</label>
      <input type="date" name="date" value="{{ selected_date }}" class="form-control d-inline-block" style="width: auto;">
      <button type="submit" class="btn btn-success">‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
    </form>
  </div>

  <div class="text-center mb-4">
    <h4 class="text-primary">‡¶Ü‡¶≤-‡¶á‡¶®‡¶∏‡¶æ‡¶´ ‡¶ï‡ßç‡¶∑‡ßÅ‡¶¶‡ßç‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶∏‡¶Æ‡¶¨‡¶æ‡¶Ø‡¶º ‡¶∏‡¶Æ‡¶ø‡¶§‡¶ø ‡¶≤‡¶ø:</h4>
    <h5>‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</h5>
    <p>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: {{ report_date }}</p>
  </div>

  <!-- Summary Section -->
  <table class="table table-bordered table-sm mb-4">
    <thead class="table-primary">
      <tr>
        <th>‡¶Æ‡ßã‡¶ü ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø</th>
        <th>‡¶Æ‡ßã‡¶ü ‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º</th>
        <th>‡¶Æ‡ßã‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ</th>
        <th>‡¶ï‡¶≤‡ßç‡¶Ø‡¶æ‡¶£ ‡¶´‡¶ø</th>
        <th>‡¶≠‡¶∞‡ßç‡¶§‡¶ø ‡¶´‡¶ø</th>
        <th>‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶´‡¶ø</th>
        <th>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® ‡¶ñ‡¶∞‡¶ö</th>
      </tr>
    </thead>
    <tbody>
      <tr class="table-light">
        <td class="text-end"><strong>‡ß≥{{ "{:,.2f}".format(total_installment or 0) }}</strong></td>
        <td class="text-end"><strong>‡ß≥{{ "{:,.2f}".format(total_saving or 0) }}</strong></td>
        <td class="text-end"><strong>‡ß≥{{ "{:,.2f}".format((total_installment or 0) + (total_saving or 0)) }}</strong></td>
        <td class="text-end"><strong>‡ß≥{{ "{:,.2f}".format(total_welfare_fee or 0) }}</strong></td>
        <td class="text-end"><strong>‡ß≥{{ "{:,.2f}".format(total_admission_fee or 0) }}</strong></td>
        <td class="text-end"><strong>‡ß≥{{ "{:,.2f}".format(total_application_fee or 0) }}</strong></td>
        <td class="text-end"><strong>‡ß≥{{ "{:,.2f}".format(total_expense or 0) }}</strong></td>
      </tr>
    </tbody>
  </table>

  <!-- Member Details -->
  <table class="table table-bordered table-sm mb-4">
    <thead class="table-dark">
      <tr>
        <th>‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶æ ‡¶®‡¶Ç</th>
        <th>‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶æ ‡¶®‡¶æ‡¶Æ</th>
        <th>‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø</th>
        <th>‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º</th>
      </tr>
    </thead>
    <tbody>
      {% for item in collections %}
      <tr {% if item.loan_amount == 0 and item.saving_amount == 0 %}class="table-warning"{% endif %}>
        <td>{{ item.customer.member_no or '-' }}</td>
        <td>{{ item.customer.name }}</td>
        <td class="text-end">{{ "{:,.2f}".format(item.loan_amount or 0) if item.loan_amount and item.loan_amount > 0 else '' }}</td>
        <td class="text-end">{{ "{:,.2f}".format(item.saving_amount or 0) if item.saving_amount and item.saving_amount > 0 else '' }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Fund Calculation -->
  <table class="table table-bordered table-sm">
    <thead class="table-success">
      <tr>
        <th colspan="2" class="text-center">‡¶∏‡¶¨ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>‡¶≤‡ßã‡¶® ‡¶¨‡¶ø‡¶§‡¶∞‡¶£</td>
        <td class="text-end">‡ß≥{{ "{:,.2f}".format(total_loan_distributed or 0) }}</td>
      </tr>
      <tr>
        <td>‡¶∏‡¶û‡ßç‡¶ö‡¶Ø‡¶º ‡¶´‡ßá‡¶∞‡¶§ / Withdrawal</td>
        <td class="text-end">‡ß≥{{ "{:,.2f}".format(total_withdrawal or 0) }}</td>
      </tr>
      <tr>
        <td>‡¶ï‡¶≤‡ßç‡¶Ø‡¶æ‡¶£ ‡¶´‡¶ø ‡¶•‡ßá‡¶ï‡ßá</td>
        <td class="text-end">‡ß≥{{ "{:,.2f}".format(total_welfare_fee or 0) }}</td>
      </tr>
      <tr>
        <td>‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶´‡¶ø ‡¶•‡ßá‡¶ï‡ßá</td>
        <td class="text-end">‡ß≥{{ "{:,.2f}".format(total_application_fee or 0) }}</td>
      </tr>
      <tr>
        <td>‡¶≠‡¶∞‡ßç‡¶§‡¶ø ‡¶´‡¶ø ‡¶•‡ßá‡¶ï‡ßá</td>
        <td class="text-end">‡ß≥{{ "{:,.2f}".format(total_admission_fee or 0) }}</td>
      </tr>
      <tr class="table-danger">
        <td><strong>‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ø‡¶º</strong></td>
        <td class="text-end"><strong>‡ß≥{{ "{:,.2f}".format(total_outflow or 0) }}</strong></td>
      </tr>
    </tbody>
  </table>
</body>
</html>
